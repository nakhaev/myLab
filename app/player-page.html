<!doctype html>
<html>

    <head>
      <meta charset="UTF8">
      <title>Untitled Document</title>
      <style>
        html, body {
            height: 100%;
        }
        #video-wrapper {
            position: relative;
            top: 50%;
            margin-top: -180px;
        }
        .video-js {
            width: 640px;
            height: 360px;
            margin: 0 auto;
        }
      </style>
    </head>

    <body>
      <div id="video-wrapper"></div>
      <script type="text/JavaScript">
      (function() {
            var player = {
                init: function() {
                    this.getPlayerData();
                    this.addPlayer();
                },

                myPlayer: null,
                playerData: {},

                getPlayerData: function() {
                    // example of url href='player-page.html?{"videoData":{"accountId":"1752604059001","playerId":"04ee9f58-9d08-43ea-803f-abda86776db2","videoId":"3851380732001"},"captionData":{"enTrack":{"src":"http://solutions.brightcove.com/bcls/assets/captions/intro-vcs.vtt","srclang":"en","label":"English"},"jpTrack":{"src":"http://solutions.brightcove.com/bcls/assets/captions/intro-vcs-jp.vtt","srclang":"jp","label":"Japanise"}}}'
        
                    var data = window.location.search.replace('?','').split('%22').join('"');
                    this.playerData = JSON.parse(data);
                    console.log(this.playerData.captionData);
                    
                },

                addPlayer: function () {
                    //dynamically build the track element
                    var tracks = '';
                    for(key in this.playerData.captionData) {
                        if(tracks == '') {
                        var temp = '<track kind=\"captions\" src=\"' + this.playerData.captionData[key].src + '\" srclang=\"' + this.playerData.captionData[key].srclang + '\" label=\"' + this.playerData.captionData[key].label + '\" mode = \"showing\" default>';
                    } else {
                        var temp = '<track kind=\"captions\" src=\"' + this.playerData.captionData[key].src + '\" srclang=\"' + this.playerData.captionData[key].srclang + '\" label=\"' + this.playerData.captionData[key].label + '\">';
                    }
                        tracks = tracks + temp;
                    }
                    console.log(tracks);


                  // dynamically build the player video element
                  var playerHTML = '<video id=\"myPlayer\" data-video-id=\"' + this.playerData.videoData.videoId + '\"  data-account=\"' + this.playerData.videoData.accountId + '\" data-player=\"' + this.playerData.videoData.playerId + '\" data-embed=\"default\" class=\"video-js\" controls>' + tracks + '</video>';
                  // inject the player code into the DOM
                  document.getElementById('video-wrapper').innerHTML = playerHTML;
                  // add and execute the player script tag
                  var s = document.createElement('script');
                  s.src = "//players.brightcove.net/" + this.playerData.videoData.accountId + "/" + this.playerData.videoData.playerId + "_default/index.min.js";
                  document.body.appendChild(s);
                  s.onload = this.callback;
                },

                callback: function() {
                    this.myPlayer.play();
                }
            }

            player.init();
        })();
      </script>
    </body>

</html>